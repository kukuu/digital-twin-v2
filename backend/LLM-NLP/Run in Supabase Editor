{/*Run in Supabase Editor*/}

-- Enable PGVector
CREATE EXTENSION IF NOT EXISTS vector;

-- Add LLM context tables
CREATE TABLE llm_queries (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  meter_id VARCHAR(255) REFERENCES readings(meter_id),
  query TEXT NOT NULL,
  response JSONB,
  embeddings vector(1536),  -- OpenAI embeddings
  created_at TIMESTAMPTZ DEFAULT NOW()
);